# NOFX ç­–ç•¥ç¼–è¾‘ç³»ç»Ÿ - å®Œæ•´å¯è§†åŒ–æŒ‡å—

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         NOFX äº¤æ˜“å¹³å°                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Web å‰ç«¯ (React)         â”‚      â”‚  AI Models / Exchanges   â”‚    â”‚
â”‚  â”‚  â”œâ”€ Strategy Studio       â”‚      â”‚  â”œâ”€ DeepSeek             â”‚    â”‚
â”‚  â”‚  â”œâ”€ Trader Management     â”‚      â”‚  â”œâ”€ GPT, Claude, etc     â”‚    â”‚
â”‚  â”‚  â””â”€ Dashboard             â”‚      â”‚  â””â”€ Binance, Bybit, etc  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          API Server (Go/Gin)                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Authentication & Auth                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Strategy Management    â† æˆ‘ä»¬ä¼˜åŒ–çš„é‡ç‚¹                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ Trader Management                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ Trading Execution                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ Debate Arena                                            â”‚   â”‚
â”‚  â”‚  â””â”€ Market Data                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Data Layer (GORM)        â”‚        â”‚  Encryption Service  â”‚   â”‚
â”‚  â”‚  â”œâ”€ Strategy Store        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚  â”œâ”€ Trader Store          â”‚                                    â”‚
â”‚  â”‚  â”œâ”€ AI Model Store        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â””â”€ Trading History       â”‚        â”‚  Backtest Engine     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚  Database (SQLite/PG)     â”‚                                   â”‚
â”‚  â”‚  â”œâ”€ strategies table       â”‚                                   â”‚
â”‚  â”‚  â”œâ”€ traders table          â”‚                                   â”‚
â”‚  â”‚  â””â”€ other tables           â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ç­–ç•¥ç¼–è¾‘å·¥ä½œæµè¯¦è§£

### å®Œæ•´çš„äº¤äº’æµç¨‹

```
ç”¨æˆ·æ“ä½œ                API è¯·æ±‚                  åç«¯å¤„ç†                 æ•°æ®åº“                å“åº”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚         â”‚           â”‚          â”‚           â”‚          â”‚           â”‚         â”‚          â”‚      â”‚
â”‚ æ‰“å¼€ç­–ç•¥ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ GET /api â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Handler  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Query   â”œâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚ JSON â”‚
â”‚ å·¥ä½œå®¤  â”‚ /strategies   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  List()  â”‚ User    â”‚          â”‚  è¿”å›   â”‚
â”‚         â”‚           â”‚          â”‚           â”‚ Strategy â”‚           â”‚  ç­–ç•¥   â”‚          â”‚      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  åˆ—è¡¨    â”‚           â”‚         â”‚          â””â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ é€‰æ‹©ç­–ç•¥
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯åŠ è½½ç¼–è¾‘å™¨  â”œâ”€>â”‚ GET /api/    â”œâ”€>â”‚ Handler      â”œâ”€>â”‚ Get()       â”œâ”€>â”‚ è¿”å›ç­–ç•¥ â”‚
â”‚ æ˜¾ç¤ºé…ç½®        â”‚  â”‚ strategies/:id â”‚  â”‚ GetStrategy  â”‚  â”‚ è¯¦æƒ…         â”‚  â”‚ é…ç½®ä¿¡æ¯ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ ç¼–è¾‘é…ç½®
     â”‚ (coin source / indicators / risk control / prompt)
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯éªŒè¯ (å®æ—¶)     â”‚ â† validateConfig Hook
â”‚ â”œâ”€ å¸ç§æ¥æº        â”‚
â”‚ â”œâ”€ æŠ€æœ¯æŒ‡æ ‡        â”‚
â”‚ â”œâ”€ é£æ§å‚æ•°        â”‚
â”‚ â””â”€ é”™è¯¯æç¤º        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ ç”¨æˆ·ç‚¹å‡» Save
       v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯éªŒè¯    â”œâ”€>â”‚ POST /api/   â”œâ”€>â”‚ Handler      â”œâ”€>â”‚ Validate()   â”œâ”€>â”‚ æ£€æŸ¥é…ç½® â”‚
â”‚ (å®Œæ•´)      â”‚  â”‚ strategies/  â”‚  â”‚ UpdateStrategy â”‚  â”‚ æ‰€æœ‰å­—æ®µ    â”‚  â”‚ æœ‰æ•ˆæ€§  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ validate-    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                 â”‚ config       â”‚                                             â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             v
                                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                        â”‚ å¦‚æœæ— æ•ˆ  â”‚
                                                                        â”‚ è¿”å›é”™è¯¯  â”‚
                                                                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                                                             â”‚
                                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                              â”‚                           â”‚
                                                    (é”™è¯¯)    v                  (æˆåŠŸ)   v
                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                 â”‚ æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯  â”‚            â”‚ PUT /api/   â”‚
                                                 â”‚ ç­‰å¾…ç”¨æˆ·ä¿®æ”¹  â”‚            â”‚ strategies/:id â”‚
                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                                  â”‚
                                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                                                                 v
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ Handler           â”‚
                                                        â”‚ UpdateStrategy    â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                                                                 v
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ Update()         â”‚
                                                        â”‚ æ›´æ–°æ•°æ®åº“è®°å½•    â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                                                                 v
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ è¿”å›æˆåŠŸå“åº”     â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                                                                 v
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ æ¸…é™¤ç¼–è¾‘çŠ¶æ€      â”‚
                                                        â”‚ hasChanges=false  â”‚
                                                        â”‚ æ¸…é™¤è‰ç¨¿          â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ å‰ç«¯ç»„ä»¶æ¶æ„ï¼ˆé‡æ„åï¼‰

### å½“å‰çŠ¶æ€ï¼ˆéœ€æ”¹è¿›ï¼‰
```
StrategyStudioPage.tsx (1000+ è¡Œ)
â”œâ”€â”€ åˆ—è¡¨ç®¡ç†é€»è¾‘
â”œâ”€â”€ ç¼–è¾‘å™¨é€»è¾‘
â”œâ”€â”€ é¢„è§ˆé€»è¾‘
â”œâ”€â”€ API è°ƒç”¨
â”œâ”€â”€ çŠ¶æ€ç®¡ç†
â””â”€â”€ UI æ¸²æŸ“
     âŒ è‡ƒè‚¿ã€éš¾ä»¥ç»´æŠ¤ã€éš¾ä»¥æµ‹è¯•
```

### é‡æ„åï¼ˆæ¨èï¼‰
```
StrategyStudioPage.tsx (200 è¡Œ - ä¸»å®¹å™¨)
â”œâ”€â”€ useStrategyStore Hook (çŠ¶æ€ç®¡ç†)
â”‚   â”œâ”€â”€ selectStrategy()
â”‚   â”œâ”€â”€ updateConfig()
â”‚   â”œâ”€â”€ setValidationErrors()
â”‚   â””â”€â”€ dispatch()
â”‚
â”œâ”€â”€ useConfigValidator Hook (éªŒè¯)
â”‚   â”œâ”€â”€ validateConfig()
â”‚   â””â”€â”€ é˜²æŠ– 300ms
â”‚
â”œâ”€â”€ useDraftSave Hook (è‰ç¨¿)
â”‚   â”œâ”€â”€ saveDraft()
â”‚   â”œâ”€â”€ loadDraft()
â”‚   â””â”€â”€ è‡ªåŠ¨ä¿å­˜ 30s
â”‚
â””â”€â”€ ä¸‰åˆ—å¸ƒå±€
    â”œâ”€â”€ StrategyListPanel (150 è¡Œ)
    â”‚   â”œâ”€â”€ ç­–ç•¥åˆ—è¡¨
    â”‚   â”œâ”€â”€ åˆ›å»º/åˆ é™¤/å¤åˆ¶
    â”‚   â””â”€â”€ çŠ¶æ€å¾½ç« 
    â”‚
    â”œâ”€â”€ StrategyEditorPanel (300 è¡Œ)
    â”‚   â”œâ”€â”€ åŸºæœ¬ä¿¡æ¯ç¼–è¾‘
    â”‚   â”œâ”€â”€ 6 ä¸ªæ ‡ç­¾é¡µ
    â”‚   â”‚   â”œâ”€ Basic Info
    â”‚   â”‚   â”œâ”€ Coin Source
    â”‚   â”‚   â”œâ”€ Indicators
    â”‚   â”‚   â”œâ”€ Risk Control
    â”‚   â”‚   â”œâ”€ Prompt
    â”‚   â”‚   â””â”€ Publish
    â”‚   â”œâ”€ å®æ—¶éªŒè¯æ˜¾ç¤º
    â”‚   â””â”€ é”™è¯¯æç¤º
    â”‚
    â””â”€â”€ PreviewPanel (150 è¡Œ)
        â”œâ”€â”€ Prompt é¢„è§ˆæ ‡ç­¾
        â”‚   â”œâ”€ ç”ŸæˆæŒ‰é’®
        â”‚   â””â”€ å†…å®¹æ˜¾ç¤º
        â””â”€â”€ AI æµ‹è¯•æ ‡ç­¾
            â”œâ”€ è¿è¡ŒæŒ‰é’®
            â””â”€ ç»“æœæ˜¾ç¤º
```

### æ•°æ®æµç¤ºæ„
```
ç”¨æˆ·äº¤äº’ â†’ React Events â†’ useStrategyStore dispatch â†’ State Update
                                â†“
                         useConfigValidator Hook
                         (è‡ªåŠ¨éªŒè¯)
                                â†“
                         UI ç»„ä»¶é‡æ–°æ¸²æŸ“
                         (æ˜¾ç¤ºé”™è¯¯/æˆåŠŸ)
                                â†“
                         è‡ªåŠ¨ saveDraft() åˆ° localStorage
```

---

## ğŸ”„ æ•°æ®ç»“æ„æ˜ å°„

### TypeScript ç±»å‹ï¼ˆå‰ç«¯ï¼‰
```typescript
interface Strategy {
  id: string
  name: string
  description: string
  config: StrategyConfig
  is_active: boolean
  is_default: boolean
  is_public: boolean
  config_visible: boolean
  created_at: string
  updated_at: string
}

interface StrategyConfig {
  language: 'zh' | 'en'
  coin_source: CoinSourceConfig
  indicators: IndicatorConfig
  risk_control: RiskControlConfig
  prompt_sections: PromptSectionsConfig
  custom_prompt?: string
}

interface IndicatorConfig {
  klines: KlineConfig
  enable_ema: boolean
  enable_macd: boolean
  enable_rsi: boolean
  // ... æ›´å¤šå­—æ®µ
  nofxos_api_key?: string
  enable_quant_data: boolean
  // ... ç­‰ç­‰
}
```

### Go ç»“æ„ä½“ï¼ˆåç«¯ï¼‰
```go
type Strategy struct {
    ID            string
    UserID        string
    Name          string
    Description   string
    IsActive      bool
    IsDefault     bool
    IsPublic      bool
    ConfigVisible bool
    Config        string    // JSON å­—ç¬¦ä¸²
    CreatedAt     time.Time
    UpdatedAt     time.Time
}

type StrategyConfig struct {
    Language       string
    CoinSource     CoinSourceConfig
    Indicators     IndicatorConfig
    RiskControl    RiskControlConfig
    PromptSections PromptSectionsConfig
    CustomPrompt   string
}
```

### æ•°æ®åº“æ¨¡å¼
```sql
CREATE TABLE strategies (
    id VARCHAR(36) PRIMARY KEY,
    user_id VARCHAR(36) NOT NULL,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    is_active BOOLEAN DEFAULT FALSE,
    is_default BOOLEAN DEFAULT FALSE,
    is_public BOOLEAN DEFAULT FALSE,
    config_visible BOOLEAN DEFAULT TRUE,
    config LONGTEXT NOT NULL DEFAULT '{}',
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    INDEX idx_user_active (user_id, is_active),
    INDEX idx_public (is_public)
);
```

---

## ğŸš¦ çŠ¶æ€è½¬æ¢å›¾

### ç­–ç•¥é€‰æ‹©æµç¨‹
```
                     åˆå§‹çŠ¶æ€
                        â”‚
                        v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ No Strategy Selected â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ ç‚¹å‡»ç­–ç•¥
                       v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Loading Strategy    â”‚ â† API GET /strategies/:id
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ åŠ è½½å®Œæˆ
                       v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Strategy Loaded     â”‚
            â”‚ Ready to Edit       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                      â”‚    â”‚
             ç¼–è¾‘é…ç½®  â”‚    â”‚ ä¸åšæ”¹åŠ¨
                      v    v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Has Changes=true   â”‚  â† hasChanges=false
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ç‚¹å‡» Save
                      v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Validating Config  â”‚ â† éªŒè¯
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
                     â”‚       â”‚
              æœ‰æ•ˆ   â”‚       â”‚ æ— æ•ˆ
                     v       v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Saving   â”‚  â”‚ Show Errors â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                 â”‚               â”‚ ç”¨æˆ·ä¿®æ”¹
                 â”‚               â””â”€â”€â†’ (å›åˆ° Has Changes)
                 â”‚
                 v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Save Success â”‚
            â”‚ Has Changes  â”‚
            â”‚ = false      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è·¯çº¿å›¾

### ç°çŠ¶
```
âŒ æ¯æ¬¡ç¼–è¾‘éƒ½é‡æ–°æ¸²æŸ“æ•´ä¸ªç¼–è¾‘å™¨
âŒ æ‰€æœ‰çŠ¶æ€é›†ä¸­åœ¨ä¸€ä¸ªç»„ä»¶
âŒ æ²¡æœ‰ç¼“å­˜æœºåˆ¶
âŒ å¤§é…ç½®å¯¹è±¡é¢‘ç¹åºåˆ—åŒ–
```

### ä¼˜åŒ–é˜¶æ®µ

#### Phase 1: ç»„ä»¶çº§ä¼˜åŒ–ï¼ˆç¬¬ä¸€å‘¨ï¼‰
```
âœ… æ‹†åˆ†ä¸ºç‹¬ç«‹ç»„ä»¶
âœ… ä½¿ç”¨ useReducer é›†ä¸­ç®¡ç†çŠ¶æ€
âœ… React.memo é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

æˆæœ: é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦ +20%ï¼Œç¼–è¾‘å“åº” +30%
```

#### Phase 2: éªŒè¯ä¼˜åŒ–ï¼ˆç¬¬äºŒå‘¨ï¼‰
```
âœ… å®æ—¶éªŒè¯ï¼ˆé˜²æŠ– 300msï¼‰
âœ… ä¸é˜»å¡ UI çš„å¼‚æ­¥éªŒè¯
âœ… å‰ç«¯ç¼“å­˜éªŒè¯ç»“æœ

æˆæœ: éªŒè¯å»¶è¿Ÿ < 200msï¼Œç”¨æˆ·ä½“éªŒæµç•…
```

#### Phase 3: åç«¯ä¼˜åŒ–ï¼ˆç¬¬ä¸‰å‘¨ï¼‰
```
âœ… Redis ç¼“å­˜æ¿€æ´»ç­–ç•¥
âœ… æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆç´¢å¼•ï¼‰
âœ… æ”¯æŒ PATCH å‡å°‘ä¼ è¾“æ•°æ®é‡

æˆæœ: API å“åº”æ—¶é—´ < 500ms
```

---

## ğŸ¯ éªŒè¯æµç¨‹è¯¦è§£

### é…ç½®éªŒè¯åˆ†å±‚

```
å±‚çº§ 1: å‰ç«¯å®¢æˆ·ç«¯éªŒè¯ (é˜²æŠ– 300ms)
â”œâ”€ æ£€æŸ¥å¿…å¡«å­—æ®µ
â”œâ”€ æ£€æŸ¥æ•°æ®ç±»å‹
â”œâ”€ æ£€æŸ¥èŒƒå›´é™åˆ¶
â””â”€ æ˜¾ç¤ºå®æ—¶é”™è¯¯æç¤º
   âœ… å¿«é€Ÿåé¦ˆï¼Œæ— ç½‘ç»œå»¶è¿Ÿ

å±‚çº§ 2: åç«¯æœåŠ¡éªŒè¯ (å®Œæ•´éªŒè¯)
â”œâ”€ éªŒè¯æ‰€æœ‰å­—æ®µ
â”œâ”€ æ£€æŸ¥ä¸šåŠ¡è§„åˆ™
â”œâ”€ æ£€æŸ¥è·¨å­—æ®µçº¦æŸ
â””â”€ è¿”å›è¯¦ç»†é”™è¯¯
   âœ… å®‰å…¨æ€§ä¿è¯ï¼Œé˜²æ­¢å®¢æˆ·ç«¯ç»•è¿‡

å±‚çº§ 3: æ•°æ®åº“çº¦æŸ
â”œâ”€ NOT NULL çº¦æŸ
â”œâ”€ å”¯ä¸€æ€§çº¦æŸ
â””â”€ å¼•ç”¨å®Œæ•´æ€§çº¦æŸ
   âœ… æœ€åä¸€é“é˜²çº¿
```

### å…·ä½“éªŒè¯è§„åˆ™ç¤ºæ„è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­—æ®µ        â”‚ ç±»å‹             â”‚ å‰ç«¯éªŒè¯ (å¿«é€Ÿ)     â”‚ åç«¯éªŒè¯ (å®Œæ•´)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ coin_source â”‚ CoinSourceConfig â”‚ æ¥æºç±»å‹æœ‰æ•ˆ        â”‚ é™æ€å¸åˆ—è¡¨ä¸ç©º    â”‚
â”‚             â”‚                  â”‚                     â”‚ é™åˆ¶æ£€æŸ¥ (>50)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ indicators  â”‚ IndicatorConfig  â”‚ è‡³å°‘ 1 æŒ‡æ ‡         â”‚ æŒ‡æ ‡å‘¨æœŸæœ‰æ•ˆ      â”‚
â”‚             â”‚                  â”‚ K-line å‘¨æœŸæœ‰æ•ˆ     â”‚ NofxOS key æ£€æŸ¥  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ risk_ctrl   â”‚ RiskControl      â”‚ èŒƒå›´æ£€æŸ¥ (0-100)    â”‚ æ—¥é™ > ç¬”é™æ£€æŸ¥  â”‚
â”‚             â”‚                  â”‚                     â”‚ ä»“ä½æ•°èŒƒå›´æ£€æŸ¥   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ prompt      â”‚ PromptSections   â”‚ é•¿åº¦æ£€æŸ¥ (<5000)    â”‚ æ ¼å¼æ£€æŸ¥          â”‚
â”‚             â”‚                  â”‚                     â”‚ æ¨¡æ¿å˜é‡æ£€æŸ¥      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ è‰ç¨¿ä¿å­˜æœºåˆ¶

### localStorage ç»“æ„
```javascript
// é”®: strategy_draft_{strategyId}
// å€¼: JSON åºåˆ—åŒ–çš„è‰ç¨¿å¯¹è±¡

{
  "config": {
    "coin_source": {...},
    "indicators": {...},
    "risk_control": {...},
    "prompt_sections": {...}
  },
  "timestamp": 1705084800000,
  "expires": 1705171200000  // 24å°æ—¶åè¿‡æœŸ
}
```

### ä¿å­˜æ—¶æœº
```
ç¼–è¾‘å¼€å§‹ â†’ æ¯ 30 ç§’è‡ªåŠ¨æ£€æŸ¥ä¸€æ¬¡
           â”œâ”€ æœ‰æ”¹åŠ¨ â†’ ä¿å­˜åˆ° localStorage
           â””â”€ æ— æ”¹åŠ¨ â†’ è·³è¿‡

ç”¨æˆ·ä¿å­˜ â†’ æ¸…é™¤ localStorage ä¸­çš„è‰ç¨¿
         â””â”€ ä¿å­˜å®Œæˆæç¤º
```

### æ¢å¤æµç¨‹
```
é¡µé¢åŠ è½½ â†’ æ£€æŸ¥æ˜¯å¦æœ‰è‰ç¨¿
         â”œâ”€ æœ‰è‰ç¨¿ä¸”æœªè¿‡æœŸ
         â”‚  â””â”€ æ˜¾ç¤º: "å‘ç°æœªä¿å­˜çš„æ›´æ”¹ï¼Œæ˜¯å¦æ¢å¤ï¼Ÿ"
         â”‚     â”œâ”€ ç”¨æˆ·ç‚¹å‡» YES â†’ åŠ è½½è‰ç¨¿
         â”‚     â””â”€ ç”¨æˆ·ç‚¹å‡» NO  â†’ åˆ é™¤è‰ç¨¿ï¼ŒåŠ è½½æœ€æ–°ç‰ˆæœ¬
         â”‚
         â””â”€ æ— è‰ç¨¿æˆ–å·²è¿‡æœŸ
            â””â”€ æ­£å¸¸åŠ è½½æœ€æ–°ç‰ˆæœ¬
```

---

## ğŸ§ª æµ‹è¯•çŸ©é˜µ

### å‰ç«¯å•å…ƒæµ‹è¯•
```
useStrategyStore
â”œâ”€ [âœ“] selectStrategy: é€‰æ‹©ç­–ç•¥
â”œâ”€ [âœ“] updateConfig: æ›´æ–°é…ç½®æŸä¸ªå­—æ®µ
â”œâ”€ [ ] dispatch: å‘é€è‡ªå®šä¹‰ action
â””â”€ [ ] çŠ¶æ€ä¸å¯å˜æ€§: ä¸ç›´æ¥ä¿®æ”¹çŠ¶æ€

useConfigValidator
â”œâ”€ [âœ“] validateConfig: éªŒè¯å®Œæ•´é…ç½®
â”œâ”€ [âœ“] å­—æ®µçº§éªŒè¯: coin_source/indicators/risk_control
â”œâ”€ [âœ“] é˜²æŠ–: 300ms å»¶è¿Ÿ
â””â”€ [âœ“] å¤šè¯­è¨€é”™è¯¯æ¶ˆæ¯

useDraftSave
â”œâ”€ [âœ“] saveDraft: ä¿å­˜åˆ° localStorage
â”œâ”€ [âœ“] loadDraft: ä» localStorage è¯»å–
â”œâ”€ [âœ“] clearDraft: åˆ é™¤è‰ç¨¿
â””â”€ [âœ“] è‡ªåŠ¨ä¿å­˜ 30s å®šæ—¶å™¨
```

### é›†æˆæµ‹è¯•
```
Strategy Edit Flow
â”œâ”€ [âœ“] åŠ è½½ç­–ç•¥åˆ—è¡¨
â”œâ”€ [âœ“] é€‰æ‹©ç­–ç•¥å¹¶åŠ è½½ç¼–è¾‘å™¨
â”œâ”€ [âœ“] ä¿®æ”¹é…ç½®
â”œâ”€ [âœ“] å®æ—¶éªŒè¯æ˜¾ç¤ºé”™è¯¯
â”œâ”€ [âœ“] ä¿®å¤é”™è¯¯åéªŒè¯é€šè¿‡
â”œâ”€ [âœ“] ç‚¹å‡» Save å‘é€ API
â”œâ”€ [âœ“] æˆåŠŸåæ¸…é™¤ hasChanges
â””â”€ [âœ“] æ¸…é™¤è‰ç¨¿æ ‡è®°
```

### E2E æµ‹è¯•ï¼ˆCypressï¼‰
```
å®Œæ•´ç”¨æˆ·æµç¨‹
â”œâ”€ ç™»å½•
â”œâ”€ æ‰“å¼€ç­–ç•¥å·¥ä½œå®¤
â”œâ”€ åˆ›å»ºæ–°ç­–ç•¥
â”œâ”€ ç¼–è¾‘å„ä¸ªå­—æ®µ
â”œâ”€ æŸ¥çœ‹éªŒè¯é”™è¯¯
â”œâ”€ ä¿å­˜æˆåŠŸ
â”œâ”€ åˆ·æ–°é¡µé¢éªŒè¯æŒä¹…åŒ–
â””â”€ æ³¨é”€
```

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

### API ç«¯ç‚¹é€ŸæŸ¥è¡¨

```
åŸºç¡€æ“ä½œ:
GET    /api/strategies              - è·å–åˆ—è¡¨
GET    /api/strategies/:id          - è·å–è¯¦æƒ…
POST   /api/strategies              - åˆ›å»º
PUT    /api/strategies/:id          - å®Œæ•´æ›´æ–°
PATCH  /api/strategies/:id          - éƒ¨åˆ†æ›´æ–° (æ–°å¢)
DELETE /api/strategies/:id          - åˆ é™¤

éªŒè¯å’Œé¢„è§ˆ:
POST   /api/strategies/validate-config              - éªŒè¯é…ç½® (æ–°å¢)
POST   /api/strategies/preview-prompt               - é¢„è§ˆ Prompt
POST   /api/strategies/test-run                     - AI æµ‹è¯•è¿è¡Œ

å¿«ç…§å’Œç‰ˆæœ¬:
POST   /api/strategies/:id/snapshots                - åˆ›å»ºå¿«ç…§ (æ–°å¢)
GET    /api/strategies/:id/snapshots                - åˆ—è¡¨å¿«ç…§ (æ–°å¢)
POST   /api/strategies/:id/snapshots/:sid/restore   - æ¢å¤å¿«ç…§ (æ–°å¢)

å…¶ä»–:
POST   /api/strategies/:id/activate    - æ¿€æ´»ç­–ç•¥
POST   /api/strategies/:id/duplicate   - å¤åˆ¶ç­–ç•¥
GET    /api/strategies/:id/diff        - è·å–å·®å¼‚ (æ–°å¢)
```

### å¸¸è§é”™è¯¯ä»£ç 

```
400 BAD_REQUEST
â”œâ”€ ç¼ºå°‘å¿…å¡«å­—æ®µ
â”œâ”€ å­—æ®µå€¼æ— æ•ˆ
â””â”€ è¯·æ±‚æ ¼å¼é”™è¯¯

401 UNAUTHORIZED
â””â”€ æœªç™»å½•æˆ– token è¿‡æœŸ

403 FORBIDDEN
â”œâ”€ æ— æƒé™ä¿®æ”¹ä»–äººçš„ç­–ç•¥
â””â”€ æ— æ³•ä¿®æ”¹ç³»ç»Ÿé»˜è®¤ç­–ç•¥

404 NOT_FOUND
â””â”€ ç­–ç•¥ä¸å­˜åœ¨

422 UNPROCESSABLE_ENTITY
â”œâ”€ éªŒè¯å¤±è´¥ (å­—æ®µå€¼é€»è¾‘é”™è¯¯)
â””â”€ è¿”å›è¯¦ç»†çš„éªŒè¯é”™è¯¯åˆ—è¡¨

500 INTERNAL_ERROR
â””â”€ æœåŠ¡å™¨é”™è¯¯
```

---

## ğŸ“ å®æ–½æ£€æŸ¥æ¸…å•

### å¼€å‘é˜¶æ®µ
- [ ] ä»£ç å®¡æŸ¥
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å®‰å…¨æ€§å®¡è®¡

### éƒ¨ç½²é˜¶æ®µ
- [ ] æ•°æ®åº“è¿ç§»è®¡åˆ’
- [ ] ç°åº¦å‘å¸ƒè®¡åˆ’ (10% â†’ 50% â†’ 100%)
- [ ] å›æ»šæ–¹æ¡ˆ
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] æ–‡æ¡£æ›´æ–°

### ä¸Šçº¿é˜¶æ®µ
- [ ] ç”¨æˆ·å…¬å‘Š
- [ ] ç¤¾åŒºåé¦ˆæ”¶é›†
- [ ] Bug çƒ­ä¿®å¤å‡†å¤‡
- [ ] æ€§èƒ½ç›‘æ§
- [ ] ç”¨æˆ·é‡‡çº³åº¦è¿½è¸ª

---

## ğŸ“ æ€»ç»“

é€šè¿‡ç³»ç»Ÿçš„é‡æ„å’Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å°†ï¼š

1. **æå‡ä»£ç è´¨é‡** ğŸ“ˆ
   - æ¨¡å—åŒ–ã€å¯æµ‹è¯•ã€å¯ç»´æŠ¤

2. **æ”¹è¿›ç”¨æˆ·ä½“éªŒ** ğŸ˜Š
   - å®æ—¶éªŒè¯ã€è‡ªåŠ¨ä¿å­˜ã€è¯¦ç»†é”™è¯¯æç¤º

3. **å¢å¼ºç³»ç»Ÿå¯é æ€§** ğŸ›¡ï¸
   - å®Œæ•´çš„éªŒè¯ã€é”™è¯¯å¤„ç†ã€æ¢å¤æœºåˆ¶

4. **ä¸ºæœªæ¥æ‰©å±•å¥ å®šåŸºç¡€** ğŸš€
   - æ¸…æ™°çš„æ¶æ„ã€æ ‡å‡†çš„ API è®¾è®¡

**é¢„è®¡æ”¶ç›Šï¼šå¼€å‘æ•ˆç‡ +40%ï¼Œç»´æŠ¤æˆæœ¬ -50%ï¼Œç”¨æˆ·æ»¡æ„åº¦ +30%**

è®©æˆ‘ä»¬å¼€å§‹è¡ŒåŠ¨å§ï¼ğŸš€
